commit 208d7206146b471e795c201c1fabaea777dee138 (from b5d9639dd0a415b5c499ee8457015609afbf89c9)
Merge: b5d9639 2aa12d7
Author: Scott Lahteine <thinkyhead@users.noreply.github.com>
Date:   Wed Oct 26 05:55:33 2016 -0500

    Merge pull request #5082 from Fulg/RCBugFix
    
    Only issue MAXTEMP when heating

diff --git a/Marlin/temperature.cpp b/Marlin/temperature.cpp
index 03ca109..08c88e6 100644
--- a/Marlin/temperature.cpp
+++ b/Marlin/temperature.cpp
@@ -1809,7 +1809,7 @@ void Temperature::isr() {
 
     for (uint8_t e = 0; e < COUNT(temp_dir); e++) {
       const int tdir = temp_dir[e], rawtemp = current_temperature_raw[e] * tdir;
-      if (rawtemp > maxttemp_raw[e] * tdir) max_temp_error(e);
+      if (rawtemp > maxttemp_raw[e] * tdir && target_temperature[e] > 0.0f) max_temp_error(e);
       if (rawtemp < minttemp_raw[e] * tdir && !is_preheating(e) && target_temperature[e] > 0.0f) {
         #ifdef MAX_CONSECUTIVE_LOW_TEMPERATURE_ERROR_ALLOWED
           if (++consecutive_low_temperature_error[e] >= MAX_CONSECUTIVE_LOW_TEMPERATURE_ERROR_ALLOWED)
@@ -1828,7 +1828,7 @@ void Temperature::isr() {
       #else
         #define GEBED >=
       #endif
-      if (current_temperature_bed_raw GEBED bed_maxttemp_raw) max_temp_error(-1);
+      if (current_temperature_bed_raw GEBED bed_maxttemp_raw && target_temperature_bed > 0.0f) max_temp_error(-1);
       if (bed_minttemp_raw GEBED current_temperature_bed_raw && target_temperature_bed > 0.0f) min_temp_error(-1);
     #endif
 

commit 208d7206146b471e795c201c1fabaea777dee138 (from 2aa12d78dc721028542371bef7c204da1d3db3f2)
Merge: b5d9639 2aa12d7
Author: Scott Lahteine <thinkyhead@users.noreply.github.com>
Date:   Wed Oct 26 05:55:33 2016 -0500

    Merge pull request #5082 from Fulg/RCBugFix
    
    Only issue MAXTEMP when heating

diff --git a/Marlin/Marlin_main.cpp b/Marlin/Marlin_main.cpp
index a215368..b99ae27 100755
--- a/Marlin/Marlin_main.cpp
+++ b/Marlin/Marlin_main.cpp
@@ -4431,41 +4431,49 @@ inline void gcode_G92() {
 
     #endif
 
+    #if ENABLED(EMERGENCY_PARSER)
+      wait_for_user = true;
+    #endif
+
+    KEEPALIVE_STATE(PAUSED_FOR_USER);
+
     stepper.synchronize();
     refresh_cmd_timeout();
 
     #if ENABLED(ULTIPANEL)
 
+      #if ENABLED(EMERGENCY_PARSER)
+        #define M1_WAIT_CONDITION (!lcd_clicked() && wait_for_user)
+      #else
+        #define M1_WAIT_CONDITION !lcd_clicked()
+      #endif
+
       if (codenum > 0) {
         codenum += previous_cmd_ms;  // wait until this time for a click
-        KEEPALIVE_STATE(PAUSED_FOR_USER);
-        while (PENDING(millis(), codenum) && !lcd_clicked()) idle();
+        while (PENDING(millis(), codenum) && M1_WAIT_CONDITION) idle();
         lcd_ignore_click(false);
       }
       else if (lcd_detected()) {
-        KEEPALIVE_STATE(PAUSED_FOR_USER);
-        while (!lcd_clicked()) idle();
+        while (M1_WAIT_CONDITION) idle();
       }
-      else return;
+      else goto ExitM1;
 
-      if (IS_SD_PRINTING)
-        LCD_MESSAGEPGM(MSG_RESUMING);
-      else
-        LCD_MESSAGEPGM(WELCOME_MSG);
+      IS_SD_PRINTING ? LCD_MESSAGEPGM(MSG_RESUMING) : LCD_MESSAGEPGM(WELCOME_MSG);
 
     #else
 
-      KEEPALIVE_STATE(PAUSED_FOR_USER);
-      wait_for_user = true;
-
       if (codenum > 0) {
         codenum += previous_cmd_ms;  // wait until this time for an M108
         while (PENDING(millis(), codenum) && wait_for_user) idle();
       }
       else while (wait_for_user) idle();
 
-      wait_for_user = false;
+    #endif
 
+ExitM1:
+
+    #if ENABLED(EMERGENCY_PARSER)
+      wait_for_user = false;
     #endif
 
     KEEPALIVE_STATE(IN_HANDLER);
@@ -8305,8 +8313,8 @@ void ok_to_send() {
     // Whole unit is the grid box index
     const int gridx = constrain(floor(ratio_x), 0, ABL_GRID_POINTS_X - 2),
               gridy = constrain(floor(ratio_y), 0, ABL_GRID_POINTS_Y - 2),
-              nextx = gridx + (x < PROBE_BED_WIDTH ? 1 : 0),
-              nexty = gridy + (y < PROBE_BED_HEIGHT ? 1 : 0);
+              nextx = min(gridx + 1, ABL_GRID_POINTS_X - 2),
+              nexty = min(gridy + 1, ABL_GRID_POINTS_Y - 2);
 
     // Subtract whole to get the ratio within the grid box
     ratio_x = constrain(ratio_x - gridx, 0.0, 1.0);
diff --git a/Marlin/SdBaseFile.cpp b/Marlin/SdBaseFile.cpp
index 412292b..298cdd1 100644
--- a/Marlin/SdBaseFile.cpp
+++ b/Marlin/SdBaseFile.cpp
@@ -674,7 +674,7 @@ bool SdBaseFile::open(SdBaseFile* dirFile,
       index = 0;
     }
     // initialize as empty file
-    ZERO(p);
+    memset(p, 0, sizeof(*p));
     memcpy(p->name, dname, 11);
 
     // set timestamps

