commit 567291e7347a2545650d9f98a79427dddab8cd22 (from 68f9f2521ea0f1f6d3cbef67a44d000aa23870fa)
Merge: 68f9f25 4241011
Author: ErikZalm <erik@vdzalm.eu>
Date:   Tue May 21 08:46:27 2013 -0700

    Merge pull request #485 from Banjer/Panelolu2_Melzi
    
    Add Panelolu2 support for Melzi

diff --git a/Marlin/pins.h b/Marlin/pins.h
index c8275e4..36f6703 100644
--- a/Marlin/pins.h
+++ b/Marlin/pins.h
@@ -735,7 +735,16 @@
      //The encoder and click button
      #define BTN_EN1 11  
      #define BTN_EN2 10 
-     #define BTN_ENC 16  //the switch
+     #ifdef LCD_I2C_PANELOLU2
+       #ifdef MELZI
+         #define BTN_ENC 29 //the click switch
+         #define SDSS 30 //to use the SD card reader on the Panelolu2 rather than the melzi board
+       #else
+         #define BTN_ENC 30 //the click switch
+       #endif
+     #else
+       #define BTN_ENC 16  //the click switch
+     #endif //Panelolu2
      //not connected to a pin
      #define SDCARDDETECT -1    
     

commit 567291e7347a2545650d9f98a79427dddab8cd22 (from 424101110c2d3907722bbabef0b4ceb2178b3553)
Merge: 68f9f25 4241011
Author: ErikZalm <erik@vdzalm.eu>
Date:   Tue May 21 08:46:27 2013 -0700

    Merge pull request #485 from Banjer/Panelolu2_Melzi
    
    Add Panelolu2 support for Melzi

diff --git a/Marlin/dogm_lcd_implementation.h b/Marlin/dogm_lcd_implementation.h
index c5192e7..c45a6a6 100644
--- a/Marlin/dogm_lcd_implementation.h
+++ b/Marlin/dogm_lcd_implementation.h
@@ -19,6 +19,19 @@
 * Implementation of the LCD display routines for a DOGM128 graphic display. These are common LCD 128x64 pixel graphic displays.
 **/
 
+ifdef ULTIPANEL
+#define BLEN_A 0
+#define BLEN_B 1
+#define BLEN_C 2
+#define EN_A (1<<BLEN_A)
+#define EN_B (1<<BLEN_B)
+#define EN_C (1<<BLEN_C)
+#define encrot0 0
+#define encrot1 2
+#define encrot2 3
+#define encrot3 1
+#define LCD_CLICKED (buttons&EN_C)
+#endif
 
 // CHANGE_DE begin ***
 #include <U8glib.h>	// DE_U8glib
diff --git a/Marlin/ultralcd.cpp b/Marlin/ultralcd.cpp
index 92c6592..4a90421 100644
--- a/Marlin/ultralcd.cpp
+++ b/Marlin/ultralcd.cpp
@@ -76,12 +76,15 @@ static void menu_action_setting_edit_callback_float51(const char* pstr, float* p
 static void menu_action_setting_edit_callback_float52(const char* pstr, float* ptr, float minValue, float maxValue, menuFunc_t callbackFunc);
 static void menu_action_setting_edit_callback_long5(const char* pstr, unsigned long* ptr, unsigned long minValue, unsigned long maxValue, menuFunc_t callbackFunc);
 
+#define ENCODER_FEEDRATE_DEADZONE 10
+
 #if !defined(LCD_I2C_VIKI)
   #define ENCODER_STEPS_PER_MENU_ITEM 5
 #else
   #define ENCODER_STEPS_PER_MENU_ITEM 2 // VIKI LCD rotary encoder uses a different number of steps per rotation
 #endif
 
+
 /* Helper macros for menus */
 #define START_MENU() do { \
     if (encoderPosition > 0x8000) encoderPosition = 0; \
@@ -165,10 +168,34 @@ static void lcd_status_screen()
     if (LCD_CLICKED)
     {
         currentMenu = lcd_main_menu;
+        encoderPosition = 0;
         lcd_quick_feedback();
     }
-    feedmultiply += int(encoderPosition);
-    encoderPosition = 0;
+
+    // Dead zone at 100% feedrate
+    if (feedmultiply < 100 && (feedmultiply + int(encoderPosition)) > 100 ||
+            feedmultiply > 100 && (feedmultiply + int(encoderPosition)) < 100)
+    {
+        encoderPosition = 0;
+        feedmultiply = 100;
+    }
+
+    if (feedmultiply == 100 && int(encoderPosition) > ENCODER_FEEDRATE_DEADZONE)
+    {
+        feedmultiply += int(encoderPosition) - ENCODER_FEEDRATE_DEADZONE;
+        encoderPosition = 0;
+    }
+    else if (feedmultiply == 100 && int(encoderPosition) < -ENCODER_FEEDRATE_DEADZONE)
+    {
+        feedmultiply += int(encoderPosition) + ENCODER_FEEDRATE_DEADZONE;
+        encoderPosition = 0;	
+    }
+    else if (feedmultiply != 100)
+    {
+        feedmultiply += int(encoderPosition);
+        encoderPosition = 0;
+    }
+
     if (feedmultiply < 10)
         feedmultiply = 10;
     if (feedmultiply > 999)

